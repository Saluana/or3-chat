/*
	Theme Base Stylesheet - Shared Foundation
	==========================================
	- Contains common retro utility classes and base component styles
	- Shared across all themes to reduce duplication
	- Themes should @import this file and then override CSS variables
*/

/* ========================================
   THEME APPLICATION DEFAULTS
   ========================================
   Shared application variables that chat components consume.
   Individual themes may override any of these values.
*/

:root {
	--app-dropzone-active-border: var(--md-primary);
	--app-dropzone-active-bg: color-mix(in oklab, var(--md-primary) 14%, transparent);
	--app-dropzone-overlay-bg: color-mix(in oklab, var(--md-primary) 22%, transparent);
	--app-dropzone-overlay-border: var(--md-primary);
	--app-dropzone-icon-color: var(--md-primary);
	--app-dropzone-text-color: var(--md-on-primary-container);
	--app-msg-user-bg: var(--md-primary);
	--app-msg-user-text: var(--md-on-primary);
	--app-msg-user-border: var(--md-inverse-surface);
	--app-msg-assistant-bg: color-mix(in oklab, var(--md-surface-container-high) 88%, transparent);
	--app-msg-assistant-text: var(--md-on-surface);
	--app-msg-assistant-border: var(--md-inverse-surface);
	--app-msg-assistant-actions-bg: var(--md-surface-container-high);
	--app-msg-action-text: var(--md-on-surface);
	--app-modal-header-bg: color-mix(in oklab, var(--md-surface) 90%, transparent);
	--app-modal-item-bg: color-mix(in oklab, var(--md-surface) 94%, transparent);
	--app-modal-item-odd-bg: color-mix(in oklab, var(--md-primary) 12%, transparent);
	--app-modal-text: var(--md-on-surface);
	--app-modal-text-muted: var(--md-on-surface-variant);
	--app-modal-border-strong: var(--md-inverse-surface);
	--app-modal-border-subtle: color-mix(in oklab, var(--app-modal-border-strong) 35%, transparent);
}

.dark,
.dark-high-contrast,
.dark-medium-contrast {
	--app-dropzone-active-bg: color-mix(in oklab, var(--md-primary) 26%, transparent);
	--app-dropzone-overlay-bg: color-mix(in oklab, var(--md-primary) 32%, transparent);
	--app-dropzone-text-color: var(--md-on-primary);
	--app-msg-user-text: var(--md-on-primary);
	--app-msg-assistant-bg: color-mix(in oklab, var(--md-surface-container-low) 78%, transparent);
	--app-msg-assistant-actions-bg: color-mix(in oklab, var(--md-surface-container-high) 70%, transparent);
	--app-modal-header-bg: color-mix(in oklab, var(--md-surface-container-high) 64%, transparent);
	--app-modal-item-bg: color-mix(in oklab, var(--md-surface-container-high) 58%, transparent);
	--app-modal-item-odd-bg: color-mix(in oklab, var(--md-primary) 18%, transparent);
}

/* ========================================
   RETRO UTILITY CLASSES
   ========================================
   Exported globally so dashboard modules share identical visuals.
   Extend styles by stacking an extra class (e.g. `.retro-chip.my-variant`).
   Do not duplicate these selectors in component-scoped blocksâ€”update here instead.
*/

/* Screen-reader only helper (follows inclusive components pattern) */
.sr-only {
	position: absolute;
	width: 1px;
	height: 1px;
	padding: 0;
	margin: -1px;
	overflow: hidden;
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	white-space: nowrap;
	border: 0;
}

/* Retro "chip" toggle button used across dashboard settings */
.retro-chip {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding: 0.25rem 0.5rem;
	font-size: 0.75rem;
	font-weight: 500;
	user-select: none;
	border: 2px solid var(--chip-border, var(--md-inverse-surface));
	box-shadow: 2px 2px 0 var(--chip-shadow, var(--md-inverse-surface));
	border-radius: var(--chip-radius, 3px);
	background: var(--chip-bg, var(--md-surface));
	color: var(--chip-color, var(--md-on-surface));
	line-height: 1;
	transition: background-color 120ms ease, color 120ms ease,
		transform 80ms ease, box-shadow 80ms ease;
}
.retro-chip:hover {
	background: var(--chip-hover-bg, var(--md-secondary-container));
	color: var(--chip-hover-color, var(--md-on-secondary-container));
}
.retro-chip:active {
	transform: translate(2px, 2px);
	box-shadow: 0 0 0 var(--chip-shadow, var(--md-inverse-surface));
}
.retro-chip.active {
	background: var(--chip-active-bg, var(--md-primary-container));
	color: var(--chip-active-color, var(--md-on-primary-container));
}
.retro-chip:focus-visible {
	outline: 2px solid var(--md-primary);
	outline-offset: 2px;
}

/* Retro text inputs (text + number inputs share the same base look) */
.retro-input {
	height: var(--input-height, 32px);
	padding: 0 6px;
	font-size: var(--input-font-size, 12px);
	font-family: inherit;
	line-height: 1;
	border: 2px solid var(--input-border, var(--md-inverse-surface));
	background: var(--input-bg, var(--md-surface));
	color: var(--input-color, var(--md-on-surface));
	border-radius: var(--input-radius, 3px);
	box-shadow: 2px 2px 0 var(--input-shadow, var(--md-inverse-surface));
	transition: all 0.3s ease;
}
.retro-input:focus-visible {
	outline: 2px solid var(--md-primary);
	outline-offset: 2px;
}
textarea.retro-input {
	height: auto;
	padding-top: 6px;
	padding-bottom: 6px;
	line-height: 1.25;
}
.retro-input:disabled {
	opacity: 0.5;
	cursor: not-allowed;
}

/* Primary retro button scaffold (used with Nuxt UI buttons) */
.retro-btn {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	line-height: 1;
	position: relative;
	border-radius: var(--btn-radius, 3px);
	border: 2px solid var(--btn-border, var(--md-inverse-surface));
	background: var(--btn-bg, var(--md-surface));
	color: var(--btn-color, var(--md-on-surface));
	box-shadow: var(--btn-shadow, 2px 2px 0 var(--md-inverse-surface));
	font-weight: var(--btn-font-weight, 600);
	transition: transform 80ms ease, box-shadow 80ms ease, all 0.3s ease;
}
.retro-btn.aspect-square {
	padding: 0;
	place-items: center;
}
.retro-btn:active {
	transform: translate(2px, 2px);
	box-shadow: 0 0 0 var(--btn-shadow, var(--md-inverse-surface)),
		inset 0 2px 0 rgba(0, 0, 0, 0.25),
		inset 0 -2px 0 rgba(255, 255, 255, 0.12);
}
.retro-btn:focus-visible {
	outline: 2px solid var(--md-primary);
	outline-offset: 2px;
}
.retro-btn:disabled {
	opacity: 0.45;
	cursor: not-allowed;
	box-shadow: 2px 2px 0 color-mix(in oklab, var(--btn-shadow, var(--md-inverse-surface)) 70%, transparent 30%);
}

/* Iconic copy button variant used in theme palette rows */
.retro-btn-copy {
	height: var(--btn-copy-height, 32px);
	padding: 0 8px;
	font-size: var(--btn-copy-font-size, 10px);
	line-height: 1;
	border: 2px solid var(--btn-copy-border, var(--md-inverse-surface));
	border-radius: var(--btn-copy-radius, 3px);
	background: var(--btn-copy-bg, var(--md-secondary-container));
	color: var(--btn-copy-color, var(--md-on-secondary-container));
	box-shadow: var(--btn-copy-shadow, 2px 2px 0 var(--md-inverse-surface));
	cursor: pointer;
	transition: transform 80ms ease, box-shadow 80ms ease,
		background-color 120ms ease, color 120ms ease;
}
.retro-btn-copy:disabled {
	opacity: 0.4;
	cursor: not-allowed;
}
.retro-btn-copy:active:not(:disabled) {
	transform: translate(2px, 2px);
	box-shadow: 0 0 0 var(--btn-copy-shadow, var(--md-inverse-surface));
}
.retro-btn-copy:focus-visible {
	outline: 2px solid var(--md-primary);
	outline-offset: 2px;
}

/* ========================================
   BASE COMPONENT STYLES
   ========================================
   Common component patterns that all themes share
*/

/* Base card styling */
.card,
.ucard,
[class*="card"] {
	background: var(--card-bg, var(--md-surface));
	border: 2px solid var(--card-border, var(--md-inverse-surface));
	border-radius: var(--card-radius, 3px);
	box-shadow: var(--card-shadow, 2px 2px 0 var(--md-inverse-surface));
	transition: all 0.3s ease;
}

/* Base modal styling */
.modal,
.umodal,
[class*="modal"] {
	background: var(--modal-bg, var(--md-surface));
	border: 3px solid var(--modal-border, var(--md-inverse-surface));
	border-radius: var(--modal-radius, 3px);
	box-shadow: var(--modal-shadow, 0 0 20px rgba(0, 0, 0, 0.2));
}

/* Base alert styling */
.alert,
.u-alert,
[class*="alert"] {
	background: var(--alert-bg, var(--md-surface-container));
	border: 2px solid var(--alert-border, var(--md-error));
	color: var(--alert-color, var(--md-error));
	border-radius: var(--alert-radius, 3px);
}

/* Base scrollbar styling */
::-webkit-scrollbar {
	width: var(--scrollbar-width, 12px);
	height: var(--scrollbar-height, 12px);
}

::-webkit-scrollbar-track {
	background: var(--scrollbar-track-bg, var(--md-surface-container));
	border: 1px solid var(--scrollbar-track-border, var(--md-outline));
}

::-webkit-scrollbar-thumb {
	background: var(--scrollbar-thumb-bg, var(--md-secondary));
	border: 1px solid var(--scrollbar-thumb-border, var(--md-outline));
	border-radius: var(--scrollbar-thumb-radius, 2px);
}

::-webkit-scrollbar-thumb:hover {
	background: var(--scrollbar-thumb-hover-bg, var(--md-secondary-container));
}

/* Base focus indicators */
*:focus {
	outline: 2px solid var(--focus-outline, var(--md-primary));
	outline-offset: var(--focus-offset, 2px);
}

/* ========================================
   PROSE STYLES
   ========================================
   Typography and content styling for rich text content.
*/

.prose-retro {
    font-family: var(--prose-font-family, "IBM Plex Sans", system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif);
    font-weight: 400;
    font-size: var(--prose-font-size, 16px);
    line-height: var(--prose-line-height, 1.7);
    color: var(--prose-color, var(--md-on-surface));
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

.prose-retro :deep(p) {
    margin-top: 1rem;
    margin-bottom: 1rem;
    line-height: 1.5;
    font-family: inherit;
    font-weight: 400;
}

.prose-retro :deep(span),
.prose-retro :deep(strong),
.prose-retro :deep(em),
.prose-retro :deep(b),
.prose-retro :deep(i) {
    font-family: inherit;
}

.prose-retro :deep(h1),
.prose-retro :deep(h2),
.prose-retro :deep(h3),
.prose-retro :deep(h4) {
    font-family: var(--prose-heading-font-family, "IBM Plex Sans", system-ui);
    color: var(--prose-heading-color, var(--md-primary));
    margin-top: 2rem;
    margin-bottom: 0.75rem;
    line-height: 1.3;
    font-weight: var(--prose-heading-weight, 600);
}

.prose-retro :deep(h1) {
    font-size: var(--prose-h1-size, 1.875rem);
    border-bottom: 2px solid var(--prose-h1-border, var(--md-inverse-surface));
    padding-bottom: 0.5rem;
    margin-bottom: 1rem;
}

.prose-retro :deep(h2) {
    font-size: var(--prose-h2-size, 1.5rem);
}

.prose-retro :deep(h3) {
    font-size: var(--prose-h3-size, 1.25rem);
}

.prose-retro :deep(a) {
    color: var(--prose-link-color, var(--md-primary));
    text-decoration: underline;
}

.prose-retro :deep(a:hover) {
    color: var(--prose-link-hover-color, var(--md-primary-variant));
}

.prose-retro :deep(code) {
    background: var(--prose-code-bg, var(--md-surface-container));
    padding: 0.1rem 0.1rem;
    color: var(--prose-code-color, var(--md-on-surface));
    font-family: var(--prose-code-font-family, 'Courier New', monospace);
    font-size: 0.9em;
}

@media (prefers-color-scheme: dark) {
    .prose-retro :deep(code) {
        color: var(--prose-code-color-dark, white);
    }
}

.prose-retro :deep(pre) {
    padding: 1rem;
    border-radius: var(--prose-pre-radius, 3px);
    border: 2px solid var(--prose-pre-border, var(--md-inverse-surface));
    overflow-x: auto;
    margin: 1rem 0;
    font-weight: 505;
}

.prose-retro :deep(pre code) {
    background: transparent;
    padding: 0;
    border: none;
    font-size: var(--prose-code-font-size, 16px);
}

/* ========================================
   ACCESSIBILITY & MOTION
   ========================================
   Shared motion reduction: keep retro UI snappy yet accessible
*/

@media (prefers-reduced-motion: reduce) {
	.retro-chip,
	.retro-btn,
	.retro-btn-copy,
	.retro-input,
	.card,
	.ucard,
	[class*="card"],
	.modal,
	.umodal,
	[class*="modal"] {
		transition: none;
		transform: none;
	}
}
